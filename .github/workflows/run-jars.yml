
name: Run JAR File

on:
  push:
    branches: [ "main" ]
    
jobs:
 run-jar:
   runs-on: windows-latest

   permissions:
      contents: read
      issues: write
      pull-requests: write

   steps:
   - name: checkout code
     uses: actions/checkout@v3
     with:
        fetch-depth: 1
     
   - name: Set up JDK 17
     uses: actions/setup-java@v4
     with:
      java-version: '17'
      distribution: 'temurin'

   - name: Install Google Chrome
     run: |
        $chrome_installer = "C:\chrome_installer.exe"
        Invoke-WebRequest -Uri "https://dl.google.com/chrome/install/standalonesetup64.exe" -OutFile $chrome_installer
        Start-Process -FilePath $chrome_installer -ArgumentList "/silent /install" -Wait
        Remove-Item -Force $chrome_installer

   - name: Run JAR files and generate report
     id: run-jars
     run: |
          # Create a directory for reports
          mkdir -p reports

          # Example JAR files to run (adjust as needed)
          jar_files= Get-ChildItem -Recurse -Filter *.jar

          # Create the report file
          report_file="reports/execution-report.md"
          echo "| JAR File         | Status |" > $report_file
          echo "|------------------|--------|" >> $report_file

          # Iterate over JAR files
          for ( jar in "${jar_files[@]}" ); do
            echo "Running $jar..."
            if ( java -jar $jar ); then
              echo "| $jar | Passed |" >> $report_file
            else
              echo "| $jar | Failed |" >> $report_file
            fi
          done

          # Output the report
          cat $report_file

   - name: Upload execution report as artifact
     uses: actions/upload-artifact@v3
     with:
          name: jar-execution-report
          path: reports/execution-report.md
